"0",""
"0","cohen_df <- do.call(cbind,lapply(cohen_list,function(x) x[intersect(trait_order, union(pos3,neg3)),2]))"
"0",""
"0","rownames(cohen_df) <- intersect(trait_order, union(pos3,neg3))"
"0",""
"0","cohen_df[is.na(cohen_df)] <- 0"
"0",""
"0",""
"0","ann_row_group <- sapply(rownames(cohen_df), function(x) {"
"0","  names(families)[which(sapply(families, function(f) x %in% f))]"
"0","})"
"0","ann_row <- as.data.frame(ann_row_group)"
"0","colnames(ann_row) <- c(""Trait"")"
"0",""
"0","ann_col_group <- sapply(colnames(cohen_df), function(x) {"
"0","  names(disease_types)[which(sapply(disease_types, function(f) x %in% f))]"
"0","})"
"0","ann_col <- as.data.frame(ann_col_group)"
"0","colnames(ann_col) <- c(""Disease"")"
"0",""
"0",""
"0","ann_colors = list("
"0","    Trait = family_colors,"
"0","    Disease = type_colors"
"0",")"
"0",""
"0","data_range <- max(abs(c(min(cohen_df, na.rm = TRUE), "
"0","                       max(cohen_df, na.rm = TRUE))))"
"0","breaks <- seq(-data_range, data_range, length.out = 101)"
"0",""
"0",""
"0","png(""../Results/EffectSize_Heatmap.png"", width = 3200, height = 2400, res = 300)"
"0",""
"0","pheatmap::pheatmap(cohen_df, cluster_rows = TRUE, cluster_cols = TRUE,"
"0","         show_rownames = TRUE, show_colnames = TRUE, "
"0","         annotation_row = ann_row,"
"0","         annotation_col = ann_col,"
"0","         annotation_colors = ann_colors, "
"0","         border_color = NA,"
"0","         #breaks = breaks,"
"0","         clustering_distance_rows = ""correlation"","
"0","         main = 'Effect Size Heatmap')"
