"0",""
"0","# Group the families, determine families in each picture"
"0","split_list <- list("
"0","  c(""Complexity""),"
"0","  c(""Fucosylation""),"
"0","  c(  ""Galactosylation"", ""Sialylation""),"
"0","  c(""Bisection"",""Sialylation_L"", ""Sialylation_E"")"
"0",")"
"0",""
"0","# List to store the forest plots"
"0","forest_list <- list()"
"0",""
"0","# and now follows a buildup of a plot "
"0","for (n in split_list) {"
"0","  p <- subset_cohen %>% "
"0","    filter(trait %in% union(pos3,neg3)) %>% "
"0","    filter(family %in% n) %>% "
"0","    ggplot(aes(x=cohen_d, y=trait)) + "
"0","    geom_effect(ggplot2::aes(xmin = CI_lower, xmax = CI_upper, colour = disease, shape = disease), fatten = 6, position = ggstance::position_dodgev(height = 0.5)) + "
"0","    scale_color_manual(values = disease_colors) + "
"0","    scale_shape_manual(values = c(RA = 19, AIH = 19, UC = 17, CD = 15, LMS = 17, COVID19 = 15, MASH = 19, T2D = 17, BC = 15, CRC = 19, MM = 17, PC = 15, PDAC = 17)) +"
"0","    theme_forest() + "
"0","    geom_stripes(odd = ""#33333333"", even = ""#00000000"") +"
"0","    geom_vline(xintercept = 0, color = ""black"", linetype = ""dashed"", cex = 1, alpha = 0.5) +  "
"0","    ggforce::facet_col(facets = ~ family, scales = ""free_y"", space = ""free"") + "
"0","    xlim(-4, 4) + xlab(""Cohen's D (CI)"") + ylab(""Glyco traits"") "
"0","  "
"0","  # As the legends might be not identical, so this approach isn't working. "
"0","  if (length(unique((subset_cohen %>% filter(family %in% n))$disease))==13) {"
"0","    p <- p + theme( legend.position = ""bottom"") + guides(color = guide_legend(nrow = 1, override.aes = list(size = 3)))"
"0","  } else {"
"0","    p <- p + guides(color = ""none"", fill = ""none"", shape = ""none"")"
"0","  }"
"0","    "
"0","  forest_list <- append(forest_list,list(p))"
"0","}"
"0",""
