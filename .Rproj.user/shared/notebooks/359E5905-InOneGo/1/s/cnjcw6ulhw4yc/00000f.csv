"0",""
"0","pca_result <- prcomp(data_numeric, scale = TRUE)"
"0",""
"0","# Print PCA summary"
"0","summary(pca_result)"
"1","Importance of components:
"
"1","                      "
"1","    PC1"
"1","    PC2"
"1","    PC3"
"1","     PC4"
"1","     PC5"
"1","     PC6"
"1","     PC7"
"1","     PC8"
"1","     PC9"
"1","    PC10"
"1","   PC11"
"1","   PC12"
"1","    PC13"
"1","    PC14"
"1","    PC15"
"1","
Standard deviation    "
"1"," 2.6927"
"1"," 1.7486"
"1"," 1.6185"
"1"," 1.33734"
"1"," 1.10959"
"1"," 0.95686"
"1"," 0.90580"
"1"," 0.77883"
"1"," 0.59647"
"1"," 0.56785"
"1"," 0.5640"
"1"," 0.5000"
"1"," 0.42881"
"1"," 0.30599"
"1"," 0.26972"
"1","
Proportion of Variance"
"1"," 0.3625"
"1"," 0.1529"
"1"," 0.1310"
"1"," 0.08942"
"1"," 0.06156"
"1"," 0.04578"
"1"," 0.04102"
"1"," 0.03033"
"1"," 0.01779"
"1"," 0.01612"
"1"," 0.0159"
"1"," 0.0125"
"1"," 0.00919"
"1"," 0.00468"
"1"," 0.00364"
"1","
Cumulative Proportion "
"1"," 0.3625"
"1"," 0.5154"
"1"," 0.6464"
"1"," 0.73580"
"1"," 0.79736"
"1"," 0.84314"
"1"," 0.88416"
"1"," 0.91449"
"1"," 0.93228"
"1"," 0.94840"
"1"," 0.9643"
"1"," 0.9768"
"1"," 0.98599"
"1"," 0.99068"
"1"," 0.99431"
"1","
"
"1","                      "
"1","    PC16"
"1","   PC17"
"1","    PC18"
"1","    PC19"
"1","    PC20"
"1","
Standard deviation    "
"1"," 0.25841"
"1"," 0.1732"
"1"," 0.10221"
"1"," 0.07153"
"1"," 0.03730"
"1","
Proportion of Variance"
"1"," 0.00334"
"1"," 0.0015"
"1"," 0.00052"
"1"," 0.00026"
"1"," 0.00007"
"1","
Cumulative Proportion "
"1"," 0.99765"
"1"," 0.9991"
"1"," 0.99967"
"1"," 0.99993"
"1"," 1.00000"
"1","
"
"0","scores <- as.data.frame(pca_result$x)  # First 2 PCs for samples"
"0","scores$Group <- group  # Add group information back"
"0",""
"0","loadings <- as.data.frame(pca_result$rotation)  # First 2 PCs for variables"
"0","loadings$Variable <- rownames(loadings)"
"0","loadings$Family <- NA"
"0","for (family in names(families)) {"
"0","  loadings$Family[loadings$Variable %in% families[[family]]] <- family"
"0","}"
"0",""
"0",""
"0","pc_range <- max(abs(range(c(scores$PC1, scores$PC2))))"
"0","loading_range <- max(abs(range(c(loadings[,1], loadings[,2]))))"
"0","auto_scale <- pc_range / loading_range * 0.3  # 0.8是调节因子"
"0",""
"0","  "
"0","scores$Group <- factor(scores$Group, levels = c(disease_order,'control'))"
"0",""
"0","variances <- (pca_result$sdev^2)/sum(pca_result$sdev^2)"
"0",""
"0","colnames(scores)[1:20] <- paste(colnames(scores[1:20]), sprintf(""%.2f%%"", variances * 100), sep = "", "")"
"0",""
"0",""
"0",""
