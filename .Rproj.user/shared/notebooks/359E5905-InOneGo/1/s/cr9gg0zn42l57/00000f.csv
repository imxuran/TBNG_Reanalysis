"0",""
"0","# Create a new column 'family' for disease family in the dataframe"
"0","cohen_long$family <- NA"
"0","for (family_name in names(families)) {"
"0","  cohen_long$family[cohen_long$trait %in% families[[family_name]]] <- family_name"
"0","}"
"0",""
"0","# Create a new column 'type' for trait family in the dataframe"
"0","cohen_long$type <- NA"
"0","for (disease_type in names(disease_types)) {"
"0","  cohen_long$type[cohen_long$disease %in% disease_types[[disease_type]]] <- disease_type"
"0","}"
"0",""
"0","# Reorder the factor levels to adjust legend order"
"0","cohen_long$disease <- factor(cohen_long$disease, levels = disease_order)"
"0",""
"0",""
"0","# Keep only the strongest effect sizes"
"0","subset_pos_cohen <- do.call(rbind, lapply(names(pos3_list), function(disease_name) {"
"0","  subset(cohen_long, disease == disease_name & trait %in% pos3_list[[disease_name]])"
"0","}))"
"0",""
"0","subset_neg_cohen <- do.call(rbind, lapply(names(neg3_list), function(disease_name) {"
"0","  subset(cohen_long, disease == disease_name & trait %in% neg3_list[[disease_name]])"
"0","}))"
"0",""
"0","subset_cohen <- rbind(subset_pos_cohen, subset_neg_cohen)"
