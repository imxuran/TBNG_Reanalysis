"0",""
"0","### Calculate the effect size, obtain one list including information on cohen'd, SE and CI for each dataset."
"0",""
"0","# Function to calculate the baised std"
"0","biased_sd <- function(x) {"
"0","  sqrt(sum((x - mean(x))^2) / length(x))"
"0","}"
"0",""
"0","# Function to calculate Cohen's d and related statistics"
"0","calculate_cohens_d <- function(df) {"
"0","  "
"0","  # Select numeric columns excluding age"
"0","  numeric_cols <- sapply(df, is.numeric) & !(tolower(names(df)) %in% c(""age"",""weight"",""height"",""pdac_binary"",""severity_score"",""sample id""))"
"0","  "
"0","  # Get two groups, only save the traits"
"0","  case <- df[df$group==""case"", numeric_cols]"
"0","             #intersect(colnames(df), setdiff(trait_order,total_traits))]"
"0","  control <- df[df$group==""control"", numeric_cols]"
"0","                #intersect(colnames(df), setdiff(trait_order,total_traits))]"
"0","  "
"0","  # Calculate means, biased standard deviations, and sample sizes"
"0","  mean_case <- apply(case, 2, mean)"
"0","  mean_control <- apply(control, 2, mean)"
"0","  sd_case <- apply(case, 2, biased_sd)"
"0","  sd_control <- apply(control, 2, biased_sd)"
"0","  len_case <- nrow(case)"
"0","  len_control <- nrow(control)"
"0","  "
"0","  # Calculate pooledSD, Cohen's d, standard error, and confidence intervals"
"0","  poolSd <- sqrt( ((len_case-1) * sd_case^2 + (len_control-1) * sd_control^2)  / (len_case+len_control-2) )"
"0","  cohenD <- (mean_case - mean_control) / poolSd"
"0","  SE_d <- sqrt( (len_case + len_control)/(len_case * len_control) + cohenD^2/(2*(len_case+len_control)) )"
"0","  CI_lower <- cohenD - 1.96 * SE_d"
"0","  CI_upper <- cohenD + 1.96 * SE_d"
"0",""
"0","  # Return a data frame for each disease with traits as rownames and stats as columns"
"0","  data.frame("
"0","    trait = colnames(case),"
"0","    cohen_d = cohenD,"
"0","    SE = SE_d,"
"0","    CI_lower = CI_lower,"
"0","    CI_upper = CI_upper"
"0","  )"
"0","}"
"0",""
