"0",""
"0","df_all_case <- bind_rows("
"0","  lapply(data_list, function(df) df[df$group==""case"", analy_traits]), .id = ""disease"")"
"0",""
"0","df_all <- bind_rows("
"0","  lapply(data_list, function(df) df[, analy_traits]), .id = ""disease"")"
"0",""
"0","dmfa_case <- DMFA(df_all_case, "
"0","             num.fact = 1,"
"0","             graph = FALSE)"
"0",""
"0","dmfa_all <- DMFA(df_all, "
"0","             num.fact = 1,"
"0","             graph = FALSE)"
"0",""
"0",""
"0","# Extract Variance"
"0","eigenvalues <- dmfa_all$eig[,1]"
"0","prop_var <- eigenvalues / sum(eigenvalues) * 100"
"0",""
"0",""
"0","## Score data"
"0","# Convert DMFA coordinates to a dataframe"
"0","dmfa_coords <- data.frame("
"0","  x = dmfa_all$ind$coord[,1],"
"0","  y = dmfa_all$ind$coord[,2],"
"0","  group = df_all$disease"
"0",")"
"0",""
"0","# Change the disease order"
"0","dmfa_coords$group <- factor(dmfa_coords$group, levels = disease_order)"
"0",""
"0",""
"0","## Loading data"
"0","# Combine data from all groups"
"0","dmfa_loadings <- data.frame()"
"0","for(i in 1:length(dmfa_all$var.partiel)) {"
"0","  loadings <- as.matrix(dmfa_all$var.partiel[[i]])"
"0","  group_data <- data.frame("
"0","    Variable = rownames(loadings),"
"0","    Dim1 = loadings[, 1],"
"0","    Dim2 = loadings[, 2],"
"0","    Group = names(dmfa_all$var.partiel)[[i]]"
"0","  )"
"0","  dmfa_loadings <- rbind(dmfa_loadings, group_data)"
"0","}"
"0",""
"0","# Create unit circle coordinates"
"0","theta <- seq(0, 2*pi, length.out = 100)"
"0","circle_data <- data.frame("
"0","  x = cos(theta),"
"0","  y = sin(theta)"
"0",")"
"0",""
"0","dmfa_loadings$Group <- factor(dmfa_loadings$Group, levels = unlist(disease_types))"
"0",""
"0",""
