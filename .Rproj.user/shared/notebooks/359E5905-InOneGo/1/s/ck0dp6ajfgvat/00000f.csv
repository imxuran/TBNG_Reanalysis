"0",""
"0","### Pool all control dataset together"
"0",""
"0",""
"0",""
"0","data_list <- lapply(data_list, function(df) {"
"0","  # Rename all age columns as ""age"", some are 'Age' / 'AGE'"
"0","  df <- rename_with(df, tolower, .cols = matches(""^age$"", ignore.case = TRUE))"
"0","  names(df)[str_detect(names(df), regex(""sex"", ignore_case = TRUE))] <- ""sex"""
"0","  # Convert a factor to numeric if 'age' exsits"
"0","  if (""age"" %in% colnames(df)) {"
"0","    df$age <- as.numeric(as.character(df$age))"
"0","  }"
"0","  return(df)"
"0","})"
"0",""
"0",""
"0","# Combine all dataframes"
"0","df <- bind_rows(data_list)"
"0",""
"0",""
"0","# Only keep control group, column: age, sex, common traits"
"0","df <- df[df$group=='control', c(""age"",""sex"", common_traits)] %>%"
"0","  # Standardize sex column"
"0","  mutate(sex = case_when("
"0","    sex %in% c('female', 'F') ~ 1,"
"0","    sex %in% c('male', 'M') ~ 0,"
"0","    TRUE ~ NA_real_"
"0","  ))"
"0",""
"0",""
"0","# Remove rows without age or sex"
"0","df <- na.omit(df)"
"0",""
"0","# Standardize all traits"
"0","df_std <- cbind(df[,1:2],scale(df[,-(1:2)]))"
"0",""
